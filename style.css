:root {
  --bg-primary: #0a1628; --bg-card: #111d33; --bg-card-hover: #162441;
  --bg-surface: #0e1a2e; --text-primary: #e8edf5; --text-secondary: #7b8fad;
  --text-muted: #4a5d7a; --border: #1a2a45; --accent: #3b82f6;
  --near-miss: #ef4444; --traffic: #f97316; --weather: #3b82f6;
  --equipment: #a855f7; --navigation: #22c55e; --other: #6b7280;
  --font-main: 'DM Sans', -apple-system, sans-serif;
  --font-mono: 'JetBrains Mono', monospace;
  --radius: 14px; --radius-sm: 8px;
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:var(--font-main);background:var(--bg-primary);color:var(--text-primary);min-height:100vh;min-height:100dvh;overflow-x:hidden;-webkit-font-smoothing:antialiased}

/* AUTH */
.auth-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 24px;text-align:center}
.auth-logo{width:72px;height:72px;background:linear-gradient(135deg,var(--accent),#60a5fa);border-radius:20px;display:flex;align-items:center;justify-content:center;font-size:36px;margin-bottom:24px;box-shadow:0 8px 32px rgba(59,130,246,0.3)}
.auth-title{font-size:26px;font-weight:700;margin-bottom:6px;letter-spacing:-0.5px}
.auth-sub{font-size:14px;color:var(--text-secondary);margin-bottom:36px;line-height:1.5}
.auth-btn{width:100%;max-width:320px;padding:14px 20px;border-radius:12px;border:1px solid var(--border);background:var(--bg-card);color:var(--text-primary);font-family:var(--font-main);font-size:15px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:10px;transition:all 0.2s}
.auth-btn:hover{background:var(--bg-card-hover);border-color:var(--text-muted)}
.auth-btn.google{border-color:#4285f4}
.auth-divider{color:var(--text-muted);font-size:12px;margin:16px 0;width:100%;max-width:320px;display:flex;align-items:center;gap:12px}
.auth-divider::before,.auth-divider::after{content:'';flex:1;height:1px;background:var(--border)}
.auth-input{width:100%;max-width:320px;padding:12px 14px;border-radius:var(--radius-sm);border:1px solid var(--border);background:var(--bg-card);color:var(--text-primary);font-family:var(--font-main);font-size:14px;outline:none;margin-bottom:8px}
.auth-input:focus{border-color:var(--accent)}
.auth-input::placeholder{color:var(--text-muted)}
.auth-link{color:var(--accent);font-size:13px;cursor:pointer;margin-top:8px;background:none;border:none;font-family:var(--font-main)}
.auth-error{color:var(--near-miss);font-size:13px;margin-bottom:8px;max-width:320px;display:none}

/* ROLE */
.role-screen{display:none;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 24px;text-align:center}
.role-title{font-size:22px;font-weight:700;margin-bottom:8px}
.role-sub{font-size:14px;color:var(--text-secondary);margin-bottom:28px}
.role-grid{display:flex;flex-direction:column;gap:10px;width:100%;max-width:320px}
.role-option{padding:18px 20px;border-radius:var(--radius);border:1px solid var(--border);background:var(--bg-card);color:var(--text-primary);font-family:var(--font-main);font-size:16px;font-weight:600;cursor:pointer;transition:all 0.2s;text-align:left;display:flex;align-items:center;gap:12px}
.role-option:hover{border-color:var(--accent);background:var(--bg-card-hover)}
.role-option .role-icon{width:40px;height:40px;border-radius:10px;background:rgba(59,130,246,0.1);display:flex;align-items:center;justify-content:center;font-size:20px}
.role-option .role-info{flex:1}
.role-option .role-desc{font-size:12px;color:var(--text-secondary);font-weight:400;margin-top:2px}
.nickname-section{margin-top:20px;width:100%;max-width:320px}

/* APP */
.app-shell{display:none}
.header{position:sticky;top:0;z-index:100;background:rgba(10,22,40,0.85);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:16px 20px 12px}
.header-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.logo{display:flex;align-items:center;gap:10px}
.logo-icon{width:32px;height:32px;background:linear-gradient(135deg,var(--accent),#60a5fa);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px}
.logo-text{font-size:17px;font-weight:700;letter-spacing:-0.3px}
.logo-text span{color:var(--text-secondary);font-weight:500}
.user-avatar{width:38px;height:38px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#60a5fa);display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;cursor:pointer;border:1px solid var(--border)}
.summary-bar{display:flex;align-items:center;gap:6px;font-size:13px;color:var(--text-secondary);font-family:var(--font-mono)}
.summary-bar .pulse{width:7px;height:7px;background:#22c55e;border-radius:50%;animation:pulse 2s ease-in-out infinite}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(.8)}}

/* FILTERS */
.filter-section{padding:12px 20px 6px}
.filter-row{display:flex;gap:6px;overflow-x:auto;scrollbar-width:none;-ms-overflow-style:none;padding-bottom:8px}
.filter-row::-webkit-scrollbar{display:none}
.filter-label{font-size:11px;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.8px;margin-bottom:6px}
.filter-chip{flex-shrink:0;padding:6px 14px;border-radius:20px;border:1px solid var(--border);background:transparent;color:var(--text-secondary);font-family:var(--font-main);font-size:13px;font-weight:500;cursor:pointer;transition:all 0.2s;white-space:nowrap}
.filter-chip:hover{border-color:var(--text-muted)}
.filter-chip.active{background:var(--accent);border-color:var(--accent);color:#fff}
.filter-chip.active[data-type="near-miss"]{background:var(--near-miss);border-color:var(--near-miss)}
.filter-chip.active[data-type="traffic"]{background:var(--traffic);border-color:var(--traffic)}
.filter-chip.active[data-type="weather"]{background:var(--weather);border-color:var(--weather)}
.filter-chip.active[data-type="equipment"]{background:var(--equipment);border-color:var(--equipment)}
.filter-chip.active[data-type="navigation"]{background:var(--navigation);border-color:var(--navigation)}
.filter-chip.active[data-type="other"]{background:var(--other);border-color:var(--other)}

/* FEED & CARDS */
.feed{padding:8px 16px 100px;display:flex;flex-direction:column;gap:10px}
.event-card{background:var(--bg-card);border-radius:var(--radius);border:1px solid var(--border);overflow:hidden;cursor:pointer;transition:all 0.25s ease;animation:cardIn 0.4s ease-out both}
.event-card:hover{border-color:var(--text-muted);transform:translateY(-1px);box-shadow:0 8px 30px rgba(0,0,0,0.3)}
@keyframes cardIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.card-type-bar{height:3px;width:100%}
.card-type-bar.near-miss{background:var(--near-miss)}.card-type-bar.traffic{background:var(--traffic)}.card-type-bar.weather{background:var(--weather)}.card-type-bar.equipment{background:var(--equipment)}.card-type-bar.navigation{background:var(--navigation)}.card-type-bar.other{background:var(--other)}
.card-body{padding:14px 16px}
.card-meta{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.card-type-badge{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:0.6px;padding:3px 8px;border-radius:4px;background:rgba(255,255,255,0.06)}
.card-type-badge.near-miss{color:var(--near-miss)}.card-type-badge.traffic{color:var(--traffic)}.card-type-badge.weather{color:var(--weather)}.card-type-badge.equipment{color:var(--equipment)}.card-type-badge.navigation{color:var(--navigation)}.card-type-badge.other{color:var(--other)}
.card-new{font-size:10px;font-weight:700;color:#22c55e;background:rgba(34,197,94,0.12);padding:2px 7px;border-radius:4px}
.card-title{font-size:16px;font-weight:600;line-height:1.35;margin-bottom:8px}
.card-preview{font-size:14px;color:var(--text-secondary);line-height:1.5;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;margin-bottom:12px}
.card-preview .role-tag{font-weight:600;color:var(--text-primary)}
.card-footer{display:flex;align-items:center;justify-content:space-between;font-size:12px;color:var(--text-muted)}
.card-footer-left{display:flex;align-items:center;gap:10px}
.card-stat{display:flex;align-items:center;gap:4px}
.card-stat svg{width:14px;height:14px}
.card-time{font-family:var(--font-mono);font-size:12px}

/* FAB */
.fab{position:fixed;bottom:28px;right:20px;z-index:90;background:linear-gradient(135deg,var(--accent),#2563eb);color:#fff;border:none;border-radius:16px;padding:14px 22px;font-family:var(--font-main);font-size:15px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:8px;box-shadow:0 6px 24px rgba(59,130,246,0.35);transition:all 0.25s}
.fab:hover{transform:translateY(-2px);box-shadow:0 10px 32px rgba(59,130,246,0.45)}
.fab svg{width:20px;height:20px}

/* BOTTOM NAV */
.bottom-nav{position:fixed;bottom:0;left:0;right:0;z-index:80;background:rgba(10,22,40,0.92);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-top:1px solid var(--border);display:flex;justify-content:space-around;padding:10px 0 env(safe-area-inset-bottom,8px)}
.nav-item{display:flex;flex-direction:column;align-items:center;gap:3px;color:var(--text-muted);font-size:10px;font-weight:500;cursor:pointer;transition:color 0.2s;padding:4px 12px}
.nav-item.active{color:var(--accent)}
.nav-item svg{width:22px;height:22px}

/* MODAL */
.modal-overlay{position:fixed;inset:0;z-index:200;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);display:none;align-items:flex-end;justify-content:center}
.modal-overlay.show{display:flex;animation:fadeIn 0.2s ease}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.modal-sheet{background:var(--bg-surface);border-radius:20px 20px 0 0;width:100%;max-width:500px;max-height:90vh;overflow-y:auto;animation:slideUp 0.3s ease;border:1px solid var(--border);border-bottom:none}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
.modal-handle{width:36px;height:4px;background:var(--text-muted);border-radius:2px;margin:12px auto 0}
.modal-header{padding:16px 20px 0;display:flex;align-items:center;justify-content:space-between}
.modal-title{font-size:18px;font-weight:700}
.modal-close{width:32px;height:32px;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--text-secondary);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px}
.modal-body{padding:20px}
.form-label{font-size:12px;font-weight:600;color:var(--text-secondary);text-transform:uppercase;letter-spacing:0.6px;margin-bottom:8px;display:block}
.form-label .required{color:var(--near-miss)}
.type-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:20px}
.type-option{padding:12px 8px;border-radius:var(--radius-sm);border:1px solid var(--border);background:var(--bg-card);color:var(--text-secondary);font-family:var(--font-main);font-size:12px;font-weight:500;text-align:center;cursor:pointer;transition:all 0.2s}
.type-option:hover{border-color:var(--text-muted)}
.type-option.selected{border-color:currentColor;background:rgba(255,255,255,0.05)}
.type-option[data-type="near-miss"].selected{color:var(--near-miss);border-color:var(--near-miss)}
.type-option[data-type="traffic"].selected{color:var(--traffic);border-color:var(--traffic)}
.type-option[data-type="weather"].selected{color:var(--weather);border-color:var(--weather)}
.type-option[data-type="equipment"].selected{color:var(--equipment);border-color:var(--equipment)}
.type-option[data-type="navigation"].selected{color:var(--navigation);border-color:var(--navigation)}
.type-option[data-type="other"].selected{color:var(--other);border-color:var(--other)}
.type-dot{width:8px;height:8px;border-radius:50%;display:inline-block;margin-right:4px}
.form-input{width:100%;padding:12px 14px;border-radius:var(--radius-sm);border:1px solid var(--border);background:var(--bg-card);color:var(--text-primary);font-family:var(--font-main);font-size:15px;outline:none;transition:border-color 0.2s;margin-bottom:16px}
.form-input:focus{border-color:var(--accent)}
.form-input::placeholder{color:var(--text-muted)}
textarea.form-input{resize:none;min-height:100px;line-height:1.5}
.submit-btn{width:100%;padding:14px;border-radius:var(--radius-sm);border:none;background:linear-gradient(135deg,var(--accent),#2563eb);color:#fff;font-family:var(--font-main);font-size:15px;font-weight:600;cursor:pointer;transition:all 0.2s;margin-top:4px}
.submit-btn:hover{box-shadow:0 4px 16px rgba(59,130,246,0.35)}
.submit-btn:disabled{opacity:0.4;cursor:not-allowed}

/* DETAIL */
.detail-overlay{position:fixed;inset:0;z-index:200;background:var(--bg-primary);display:none;flex-direction:column;overflow-y:auto}
.detail-overlay.show{display:flex;animation:fadeIn 0.2s ease}
.detail-header{position:sticky;top:0;z-index:10;background:rgba(10,22,40,0.9);backdrop-filter:blur(20px);padding:16px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px}
.back-btn{width:36px;height:36px;border-radius:10px;border:1px solid var(--border);background:var(--bg-card);color:var(--text-secondary);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:18px}
.detail-title-area{flex:1}
.detail-type-badge{font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:2px}
.detail-title{font-size:16px;font-weight:600}
.detail-body{padding:20px;flex:1}
.detail-desc{font-size:14px;color:var(--text-secondary);line-height:1.6;margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid var(--border)}
.detail-section-title{font-size:12px;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.8px;margin-bottom:12px}
.insight-card{background:var(--bg-card);border-radius:var(--radius-sm);border:1px solid var(--border);padding:14px;margin-bottom:8px}
.insight-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.insight-role{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;color:var(--accent);background:rgba(59,130,246,0.1);padding:2px 8px;border-radius:4px}
.insight-time{font-size:11px;color:var(--text-muted);font-family:var(--font-mono)}
.insight-text{font-size:14px;color:var(--text-primary);line-height:1.5}
.detail-input-area{position:sticky;bottom:0;background:rgba(10,22,40,0.92);backdrop-filter:blur(20px);border-top:1px solid var(--border);padding:14px 20px env(safe-area-inset-bottom,14px)}
.detail-input-row{display:flex;gap:10px}
.detail-input-row input{flex:1;padding:12px 14px;border-radius:12px;border:1px solid var(--border);background:var(--bg-card);color:var(--text-primary);font-family:var(--font-main);font-size:14px;outline:none}
.detail-input-row input:focus{border-color:var(--accent)}
.detail-input-row input::placeholder{color:var(--text-muted)}
.detail-send-btn{width:44px;height:44px;border-radius:12px;border:none;background:var(--accent);color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0}

/* PROFILE */
.profile-dropdown{position:absolute;top:48px;right:0;z-index:110;background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius);padding:12px;min-width:200px;box-shadow:0 12px 40px rgba(0,0,0,0.4);display:none}
.profile-dropdown.show{display:block}
.profile-info{padding:8px 4px;border-bottom:1px solid var(--border);margin-bottom:8px}
.profile-name{font-size:14px;font-weight:600}
.profile-role{font-size:12px;color:var(--text-secondary)}
.profile-email{font-size:11px;color:var(--text-muted);margin-top:2px}
.profile-action{width:100%;padding:10px 8px;border-radius:var(--radius-sm);border:none;background:transparent;color:var(--text-secondary);font-family:var(--font-main);font-size:13px;font-weight:500;cursor:pointer;text-align:left;transition:all 0.2s}
.profile-action:hover{background:var(--bg-card);color:var(--text-primary)}
.profile-action.danger{color:var(--near-miss)}

/* MISC */
.loading-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;gap:16px}
.spinner{width:36px;height:36px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin 0.8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-text{font-size:14px;color:var(--text-secondary)}
.empty-state{text-align:center;padding:60px 20px;color:var(--text-muted)}
.empty-state .empty-icon{font-size:48px;margin-bottom:16px}
.empty-state .empty-title{font-size:16px;font-weight:600;color:var(--text-secondary);margin-bottom:6px}
.empty-state .empty-desc{font-size:13px;line-height:1.5}
.toast{position:fixed;bottom:80px;left:50%;transform:translateX(-50%);background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:12px 20px;font-size:13px;color:var(--text-primary);z-index:300;box-shadow:0 8px 30px rgba(0,0,0,0.4);animation:toastIn 0.3s ease,toastOut 0.3s ease 2.5s forwards;white-space:nowrap}
@keyframes toastIn{from{opacity:0;transform:translateX(-50%) translateY(20px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}
@keyframes toastOut{to{opacity:0;transform:translateX(-50%) translateY(20px)}}
::-webkit-scrollbar{width:0}
@media(min-width:500px){.feed,.filter-section{max-width:480px;margin:0 auto}}

.card-image {
  width: 100%;
  border-radius: 12px;
  margin-top: 10px;
  margin-bottom: 10px;
  max-height: 240px;
  object-fit: cover;
}
.image-viewer {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.9);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.image-viewer.show {
  display: flex;
}

.image-viewer img {
  max-width: 95%;
  max-height: 90%;
  border-radius: 12px;
}
